(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{11:function(e,t,a){e.exports={Chat:"Chat_Chat__1bloD",Status:"Chat_Status__Ql6gi",HeaderInfo:"Chat_HeaderInfo__2G3Jg",HeaderSelect:"Chat_HeaderSelect__3gm3Z",HeaderName:"Chat_HeaderName__3uhpI",HeaderButtonsWrapper:"Chat_HeaderButtonsWrapper__4y1rF",HeaderButton:"Chat_HeaderButton__1vM7Z",HeaderButtonCancel:"Chat_HeaderButtonCancel__XvMOX",HeaderBackArrow:"Chat_HeaderBackArrow__3D2Zc",HeaderThreeDots:"Chat_HeaderThreeDots__3yO-x",ChatWindow:"Chat_ChatWindow__3ssqY",InputWrapper:"Chat_InputWrapper__rwoEC",ReplyWrapper:"Chat_ReplyWrapper__dgVoe",ReplyUser:"Chat_ReplyUser__2sq9b",ReplyCancel:"Chat_ReplyCancel__sl7VD",Input:"Chat_Input__KTqE8",SendIconWrapper:"Chat_SendIconWrapper__1JfQ7",SendIcon:"Chat_SendIcon__2P1ZI",EnterToChat:"Chat_EnterToChat__3A9Hx"}},113:function(e,t,a){e.exports={Modal:"Modal_Modal__3vmMb",Show:"Modal_Show__1UnyT"}},114:function(e,t,a){e.exports={NoSelectChat:"NoSelectChat_NoSelectChat__INBWx"}},164:function(e,t,a){e.exports={MainWindow:"App_MainWindow__2AJdN"}},165:function(e,t,a){e.exports={Background:"Background_Background__2HH-y"}},166:function(e,t,a){e.exports={Button:"Button_Button__J29al"}},175:function(e,t,a){},34:function(e,t,a){e.exports={AddChat:"CreateChat_AddChat__1-iru",Title:"CreateChat_Title__3oqyJ",Wrapper:"CreateChat_Wrapper__1ylPS",ImageWrapper:"CreateChat_ImageWrapper__2QIz2",Image:"CreateChat_Image__3eKjB",descArea:"CreateChat_descArea__zhR5N",InputName:"CreateChat_InputName__7FZOU",InputDesc:"CreateChat_InputDesc__2rltr",Input:"CreateChat_Input__-zo-o",Button:"CreateChat_Button__S5Y0V",descImageWrapper:"CreateChat_descImageWrapper__10lHT"}},35:function(e,t,a){e.exports={MessageWrapper:"Message_MessageWrapper__3HYPh",Message:"Message_Message__2z-QA",MessageWithImages:"Message_MessageWithImages__1p1gD",MessageAuthor:"Message_MessageAuthor__f4Ejo",Reply:"Message_Reply__w7vZc",ReplyUser:"Message_ReplyUser__3Vnvg",Select:"Message_Select__3_Zg1",MessageText:"Message_MessageText__24o61",ForwardMessage:"Message_ForwardMessage__3M7sB",AuthorName:"Message_AuthorName__3rk53",Date:"Message_Date__1eCVi"}},39:function(e,t,a){e.exports={ChatItem:"ChatItem_ChatItem__1arYK",Wrapper:"ChatItem_Wrapper__2HMq-",TopWrapper:"ChatItem_TopWrapper__2s6lw",BottomWrapper:"ChatItem_BottomWrapper__1bQjq",Avatar:"ChatItem_Avatar__1iOZk",Link:"ChatItem_Link__2NKAA",active:"ChatItem_active__1f8aB",Name:"ChatItem_Name__3jRFG"}},44:function(e,t,a){e.exports={UserSetting:"UserSetting_UserSetting__3JsuB",TopWrapper:"UserSetting_TopWrapper__JTB1K",Title:"UserSetting_Title__1ouIs",ImageWrapper:"UserSetting_ImageWrapper__b9ZkD",NameWrapper:"UserSetting_NameWrapper__2Ahoe",NameTitle:"UserSetting_NameTitle__2jEPL",NameInput:"UserSetting_NameInput__jE-6L",IdWrapper:"UserSetting_IdWrapper__1CEZH",SaveButton:"UserSetting_SaveButton__3z_HY"}},45:function(e,t,a){e.exports={Component:"ImageInputModal_Component__2iK1E",Images:"ImageInputModal_Images__3QoJw",TitleNoImages:"ImageInputModal_TitleNoImages__1ZSz5",Image:"ImageInputModal_Image__3toKf",ControlButtons:"ImageInputModal_ControlButtons__3aCbB",InputText:"ImageInputModal_InputText__81K4U",Button:"ImageInputModal_Button__7RxFJ"}},473:function(e,t,a){"use strict";a.r(t);var s=a(2),r=a(4),n=a.n(r),c=a(31),i=a.n(c),o=a(12),h=a(13),l=a(15),u=a(14),p=a(23),d=(a(175),a(52)),g=a.n(d),m=a(6),j=(a(176),a(7)),f="AUTH_START",b="AUTH_SUCCESS",v="AUTH_FAIL",_="SET_USER_INFO",O="AUTH_EXIT",I="CHAT_LOADING",C="CHAT_SUCCESS",x="CHAT_FAIL",M="CLEAN_CHATS_DATA",y="SET_USER_CHATS_LIST",N="SET_SEARCH_CHATS_LIST",S="APPEND_CHAT_MESSAGE",D="REMOVE_CHAT_MESSAGE",w="SET_MESSAGE",A="ADD_FIREBASE_USER_LISTENER",T=function(e){return function(t,a){j.a.database().ref("/chats/"+e+"/chatData/members").push(a().auth.UID),j.a.database().ref("/users/"+a().auth.UID+"/private/chats").push({chat:e})}},k=function(){return function(e,t){var a=t().auth.UID;e({type:A,ref:"users/"+a+"/private/chats/"}),j.a.database().ref("users/"+a+"/private/chats/").on("value",(function(t){e(U("init",t.val()))})),e({type:A,ref:"users/"+a}),j.a.database().ref("users/"+a).on("value",(function(t){e({type:_,user:a,userData:t.val()})}))}},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(a,s){if(!s().chats.chats[e]){var r=s().auth.UID;a({type:I,chatId:e}),a({type:A,ref:"chats/"+e+"/chatData"}),j.a.database().ref("chats/"+e+"/chatData").on("value",(function(s){var n=s.val();n?j.a.database().ref("chats/"+e+"/messagesData/lastChangeDate").once("value",(function(t){var s=Object(m.a)(Object(m.a)({},n),{},{id:e});t.val()?s.lastChangeMessagesDate=t.val():s.lastChangeMessagesDate=n.create,a({type:C,chatId:e,chatData:s})})):(a({type:x,chatId:e}),t&&j.a.database().ref("users/"+r+"/private/chats/"+t).remove())})),a({type:A,ref:"chats/"+e+"/messagesData/messages"}),j.a.database().ref("chats/"+e+"/messagesData/messages").orderByChild("date").on("child_added",(function(t){var r=t.val().message,n=t.val().replyChatMessageId;a({type:A,ref:"/messages/"+r}),j.a.database().ref("/messages/"+r).on("value",(function(c){var i=c.val();if(i){var o,h,l=Object(m.a)(Object(m.a)({},i),{},{id:r});n&&(l.replyChatMessageId=n),a({type:w,messageId:r,messageData:l}),a({type:S,chatId:e,chatMessageId:t.key,chatMessage:t.val(),lastChangeMessagesDate:i.date}),(null===(o=s())||void 0===o||null===(h=o.chats)||void 0===h?void 0:h.users[i.user])||(a({type:A,ref:"users/"+i.user+"/public"}),j.a.database().ref("users/"+i.user+"/public").on("value",(function(e){a({type:_,user:i.user,userData:{public:e.val()},isMainUser:!1})})))}}))})),j.a.database().ref("chats/"+e+"/messagesData/messages").on("child_removed",(function(t){a({type:D,chatId:e,chatMessageId:t.key})}))}}},U=function(e,t){return function(a,s){if("init"==e)if(t){var r=[];Object.keys(t).forEach((function(e){var s=t[e].chat;a(R(s,e)),r.push(t[e].chat)})),a({type:y,chatsList:r})}else a({type:y,chatsList:[]});if("search"==e){if(!t)return void a({type:N,chatsList:[]});var n=[];Object.keys(t).forEach((function(e){a(R(e)),n.push(e)})),a({type:N,chatsList:n})}}},E=function(e){return function(t,a){a().auth.UID;j.a.database().ref("chats/"+e).remove()}},L=a(17),W=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={isLogin:!0},e.emailRef=n.a.createRef(),e.passwordRef=n.a.createRef(),e.auth=function(){e.props.auth(e.emailRef.current.value,e.passwordRef.current.value,e.state.isLogin)},e.componentWillUnmount=function(){e.props.history.push("/chats")},e}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{className:g.a.Auth,children:[Object(s.jsx)("h1",{className:g.a.Title,children:this.state.isLogin?"\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(s.jsx)("input",{className:g.a.Input,placeholder:"\u041f\u043e\u0447\u0442\u0430",ref:this.emailRef}),Object(s.jsx)("input",{className:g.a.Input,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",ref:this.passwordRef}),this.props.error&&Object(s.jsx)("div",{className:g.a.Error,children:this.props.error}),Object(s.jsx)("div",{className:g.a.IsLogin,onClick:function(){e.setState((function(e){return{isLogin:!e.isLogin}}))},children:this.state.isLogin?"\u041d\u0435\u0442 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430?":"\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"}),Object(s.jsx)("button",{className:g.a.Button,onClick:this.auth,children:this.state.isLogin?"\u0412\u043e\u0439\u0442\u0438":"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})}}]),a}(r.Component),B=Object(p.b)((function(e){return{loading:e.auth.loading,error:e.auth.error}}),(function(e){return{auth:function(t,a,s){return e(function(e,t,a){return function(s){s({type:f}),a?j.a.auth().signInWithEmailAndPassword(e,t).then((function(e){s({type:b,UID:e.user.uid})})).catch((function(e){e.code;var t=e.message;console.log(t),s({type:v,error:t})})):j.a.auth().createUserWithEmailAndPassword(e,t).then((function(e){s({type:b,UID:e.user.uid})})).catch((function(e){e.code;var t=e.message;s({type:v,error:t})}))}}(t,a,s))},subscribeInit:function(){return e(k())}}}))(Object(L.g)(W)),H=a(164),F=a.n(H),P="/chats/:id",z=a(58),V=a.n(z),G=a(41);function J(e){var t={text:e.message.text,images:e.message.images};e.message.body&&(t={text:e.message.body.text,images:e.message.body.images}),t.text.length>15&&(t.text=t.text.substr(0,15)+"...");var a=18;return window.innerWidth<1e3&&(a=16),Object(s.jsxs)("div",{children:[Object(s.jsx)("span",{style:{color:"gray",fontSize:a},children:t.images&&"\u0424\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044f"}),t.images&&t.text&&", ",Object(s.jsx)("span",{style:{fontSize:a},children:t.text&&t.text})]})}var Z=["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"],K=function(e){var t=e+"";return t.length<2?"0"+t:t},X=function(e){var t=new Date(e),a=(Date.now()-t)/864e5;if(a<1)return K(t.getHours())+":"+K(t.getMinutes());if(a<7)return Z[t.getDay()];if(a<12){var s=t.getDay()+1,r=t.getMonth()+1,n=t.getFullYear()+"";return n=n.substring(2,4),K(s)+"."+K(r)+"."+n}},q=function(e){var t=new Date(e),a=t.getHours()+"",s=t.getMinutes()+"";return 1==a.length&&(a="0"+a),1==s.length&&(s="0"+s),a+":"+s},Y=a(39),Q=a.n(Y),$=function(e){return Object(s.jsx)(G.b,{to:"/chats/"+e.id,className:Q.a.Link,activeClassName:Q.a.active,children:Object(s.jsxs)("div",{className:Q.a.ChatItem,children:[Object(s.jsx)("div",{className:Q.a.Avatar,onClick:function(){e.delete(e.id)},children:Object(s.jsx)("img",{className:Q.a.Avatar,src:e.avatar?e.avatar:"/Images/noPhoto.jpg"})}),Object(s.jsxs)("div",{className:Q.a.Wrapper,children:[Object(s.jsxs)("div",{className:Q.a.TopWrapper,children:[Object(s.jsx)("div",{className:Q.a.Name,children:e.name}),Object(s.jsx)("div",{className:Q.a.LastMessageTime,children:X(e.lastMessage?e.lastMessage.date:e.chatCreateDate)})]}),Object(s.jsx)("div",{className:Q.a.BottomWrapper,children:e.lastMessage?Object(s.jsx)(J,{message:e.lastMessage}):Object(s.jsx)("div",{children:"\u0412\u044b \u0441\u043e\u0437\u0434\u0430\u043b\u0438 \u0447\u0430\u0442!!!"})})]})]})})},ee=a(165),te=a.n(ee);function ae(e){var t={},a=e.level?e.level:1;return t.zIndex=100*a,Object(s.jsx)("div",{className:te.a.Background,onClick:e.close,style:t})}var se=a(73),re=a.n(se),ne=a(113),ce=a.n(ne),ie=function(e){var t={};e.noPadding&&(t.padding=0);var a=e.level?e.level:1;t.zIndex=101*a;var r=[ce.a.Modal];return e.show&&r.push(ce.a.Show),Object(s.jsxs)(n.a.Fragment,{children:[e.show&&Object(s.jsx)(ae,{close:e.close,level:e.level}),Object(s.jsx)("div",{className:r.join(" "),style:t,children:e.children})]})},oe=a(34),he=a.n(oe),le=a(166),ue=a.n(le);function pe(e){var t=[ue.a.Button];return e.className&&t.push(e.className),Object(s.jsx)("button",{className:t.join(" "),onClick:e.onClick,children:e.children})}var de=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={showImageInputModal:!1,image:!1},e.nameRef=Object(r.createRef)(),e.descRef=Object(r.createRef)(),e.imageInputRef=Object(r.createRef)(),e.createChat=function(){e.props.createChat(e.nameRef.current.value,e.descRef.current.value,e.state.image)},e.save=function(t){e.setState({images:t})},e.selectFile=function(t){var a=t.target.files[0];if(a){var s=new FileReader;s.onloadend=function(t){t.target.result.match(t)&&e.setState({image:t.target.result})},s.readAsDataURL(a)}},e}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return Object(s.jsx)(ie,{show:this.props.show,close:this.props.hideModal,children:Object(s.jsxs)("div",{className:he.a.AddChat,children:[Object(s.jsx)("h2",{className:he.a.Title,children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0447\u0430\u0442"}),Object(s.jsxs)("div",{className:he.a.Wrapper,children:[Object(s.jsx)("h3",{className:he.a.InputName,children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0447\u0430\u0442\u0430"}),Object(s.jsx)("input",{ref:this.nameRef,className:he.a.Input})]}),Object(s.jsxs)("div",{className:he.a.Wrapper,children:[Object(s.jsxs)("div",{className:he.a.descImageWrapper,children:[Object(s.jsx)("h3",{className:he.a.InputDesc,children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0447\u0430\u0442\u0430"}),Object(s.jsxs)("div",{className:he.a.ImageWrapper,onClick:function(){e.setState({showImageInputModal:!0})},children:[Object(s.jsx)("img",{className:he.a.Image,onClick:function(){e.imageInputRef.current.click()},src:this.state.image?this.state.image:"/Images/noPhoto.jpg"}),Object(s.jsx)("input",{ref:this.imageInputRef,style:{display:"none"},type:"file",id:"inputFile",onChange:this.selectFile,accept:"image/*"})]})]}),Object(s.jsx)("textarea",{ref:this.descRef,className:he.a.descArea})]}),Object(s.jsx)(pe,{onClick:this.createChat,children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0447\u0430\u0442"})]})})}}]),a}(r.Component),ge=a(44),me=a.n(ge),je=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={imagesModal:!1},e.NameInputRef=n.a.createRef(),e.selectFile=function(t){var a=t.target.files[0];if(a){var s=new FileReader;s.onloadend=function(t){t.target.result.match(t)&&e.setState({imagesModal:t.target.result})},s.readAsDataURL(a)}},e.imageInputRef=n.a.createRef(),e}return Object(h.a)(a,[{key:"componentDidUpdate",value:function(){this.props.public&&this.NameInputRef.current&&(this.NameInputRef.current.value=this.props.public.name)}},{key:"render",value:function(){var e=this;return Object(s.jsx)(n.a.Fragment,{children:Object(s.jsx)(ie,{show:this.props.show,close:this.props.hideModal,level:2,children:Object(s.jsxs)("div",{className:me.a.UserSetting,children:[Object(s.jsx)("h2",{className:me.a.Title,children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"}),Object(s.jsxs)("div",{className:me.a.TopWrapper,children:[Object(s.jsxs)("div",{className:me.a.ImageWrapper,onClick:function(){e.imageInputRef.current.click()},children:[Object(s.jsx)("input",{ref:this.imageInputRef,style:{display:"none"},type:"file",onChange:this.selectFile,accept:"image/*"}),Object(s.jsx)("img",{src:this.state.imagesModal?this.state.imagesModal:"/Images/noPhoto.jpg"})]}),Object(s.jsxs)("div",{className:me.a.NameWrapper,children:[Object(s.jsx)("h3",{className:me.a.NameTitle,children:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),Object(s.jsx)("input",{ref:this.NameInputRef,className:me.a.NameInput})]})]}),Object(s.jsx)(pe,{className:me.a.SaveButton,onClick:function(){e.props.save("images",e.NameInputRef.current.value),e.props.hideModal()},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0438\u043d\u0435\u043d\u0438\u044f"})]})})})}}]),a}(r.Component),fe=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={showCreateChat:!1,showSetting:!1},e.createChat=function(t,a,s){e.props.createChat(t,a,s),e.setState({showCreateChat:!1}),e.props.close()},e.enterToChat=function(t){e.props.enterToChat(t),e.props.close()},e}return Object(h.a)(a,[{key:"render",value:function(){var e,t=this;return this.props.show?Object(s.jsxs)(n.a.Fragment,{children:[Object(s.jsx)(ae,{close:this.props.close}),Object(s.jsxs)("div",{className:re.a.Navigation,children:[Object(s.jsxs)("ul",{children:[Object(s.jsx)("li",{className:re.a.ListItem,onClick:function(){t.setState({showCreateChat:!0})},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0447\u0430\u0442"}),Object(s.jsx)("li",{className:re.a.ListItem,onClick:function(){t.setState({showSetting:!0})},children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"}),Object(s.jsx)("li",{className:re.a.ListItem,onClick:function(){t.props.userExit()},children:"\u0412\u044b\u0439\u0442\u0438 \u0441 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"})]}),Object(s.jsx)(de,{show:this.state.showCreateChat,hideModal:function(){t.setState({showCreateChat:!1})},createChat:this.createChat}),Object(s.jsx)(je,{show:this.state.showSetting,hideModal:function(){t.setState({showSetting:!1})},UID:this.props.UID,public:null===(e=this.props.userInfo)||void 0===e?void 0:e.public,save:this.props.changeUserSetting})]})]}):null}}]),a}(r.Component),be=Object(p.b)((function(e){return{UID:e.auth.UID,userInfo:e.chats.users[e.auth.UID]}}),(function(e){return{createChat:function(t,a,s){return e(function(e,t,a){return function(s,r){var n=r().auth.UID;j.a.database().ref("/chats").push({chatData:{creator:r().auth.UID,name:e,description:t,create:j.a.database.ServerValue.TIMESTAMP},messagesData:{lastChangeDate:j.a.database.ServerValue.TIMESTAMP},searchName:e}).then((function(e){a&&j.a.database().ref("/chats/"+e.path.pieces_[1]+"/chatData/images").push(a),j.a.database().ref("/users/"+n+"/private/chats").push({chat:e.path.pieces_[1]}),j.a.database().ref("/chats/"+e.path.pieces_[1]+"/chatData/members").push(n)}))}}(t,a,s))},enterToChat:function(t){return e(T(t))},changeUserSetting:function(t,a){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(a,s){e&&j.a.database().ref("users/"+s().auth.UID+"/public/images").set(e),t&&j.a.database().ref("users/"+s().auth.UID+"/public/name").set(t)}}(t,a))},userExit:function(){return e((function(e,t){e({type:O}),e({type:M}),t().auth.userListeners.forEach((function(e){j.a.database().ref(e).off()}))}))}}}))(fe),ve=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={showNavigation:!1},e.selectChat=function(t){t&&e.props.history.push("/chats/"+t)},e.showModal=function(){e.setState({showNavigation:!0})},e.hideModal=function(){e.setState({showNavigation:!1})},e.searchRef=n.a.createRef(),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){this.props.UID&&!this.props.users[this.props.UID]&&this.props.subscribeInit()}},{key:"render",value:function(){var e,t=this,a=Math.max(document.documentElement.clientHeight,window.innerHeight||0),r=this.props.chats,n=this.props.userChatsList,c="USER_CHATS_LIST";return(null===(e=this.searchRef.current)||void 0===e?void 0:e.value)&&(n=this.props.searchChatsList,c="SEARCH_CHATS_LIST"),Object(s.jsxs)("div",{className:V.a.ChatsList,children:[Object(s.jsxs)("div",{className:V.a.Navigation,children:[Object(s.jsx)("div",{className:V.a.Burger,onClick:this.showModal,children:Object(s.jsx)("img",{src:"/Images/menuBurger.svg"})}),Object(s.jsx)("div",{className:V.a.Input,children:Object(s.jsx)("input",{ref:this.searchRef,placeholder:"\u041f\u043e\u0438\u0441\u043a \u0447\u0430\u0442\u043e\u0432",onChange:function(){t.props.test(t.searchRef.current.value)}})})]}),Object(s.jsx)("div",{className:V.a.ChatsItems,style:{height:a-50},children:n.length>0?n.sort((function(e,t){var a=r[e],s=r[t],n=a.lastChangeMessagesDate?a.lastChangeMessagesDate:a.create;return(s.lastChangeMessagesDate?s.lastChangeMessagesDate:s.create)-n})).map((function(e){var a=r[e];if("NOT_EXIST"==a)return null;if("LOADING"==a)return null;var n=a.messages,c=null;if(Object.keys(n).length>0){var i=-1;Object.values(n).forEach((function(e){var a=t.props.messages[e.message];a.date>i&&(i=a.date,c=a)}))}return Object(s.jsx)($,{id:a.id,name:a.name,avatar:a.images&&a.images[Object.keys(a.images)[Object.keys(a.images).length-1]],chatCreateDate:a.create,delete:t.props.deleteChat,lastMessage:c},e)})):Object(s.jsx)("div",{className:V.a.NoSearchChat,children:"USER_CHATS_LIST"==c?"\u0423 \u0432\u0430\u0441 \u0435\u0449\u0435 \u043d\u0435\u0442 \u0447\u0430\u0442\u043e\u0432":"\u0427\u0430\u0442\u043e\u0432 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"})}),Object(s.jsx)(be,{show:this.state.showNavigation,close:this.hideModal})]})}}]),a}(r.Component),_e=Object(p.b)((function(e){return{chats:e.chats.chats,messages:e.chats.messages,userChatsList:e.chats.userChatsList,searchChatsList:e.chats.searchChatsList,UID:e.auth.UID,users:e.chats.users}}),(function(e){return{enterToChat:function(t){return e(T(t))},subscribeInit:function(){return e(k())},deleteChat:function(t){return e(E(t))},test:function(t){return e(function(e){return function(t,a){j.a.database().ref("chats/").orderByChild("searchName").startAt(e).endAt(e+"\uf8ff").once("value",(function(e){t(U("search",e.val()))}))}}(t))}}}))(Object(L.g)(ve)),Oe=a(49),Ie=a(11),Ce=a.n(Ie),xe=a(86),Me=a.n(xe),ye=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={focusImage:-1},e.getImageWidth=function(e,t){return{0:[0],1:[100],2:[100,100],3:[100,50,50],4:[100,100/3,100/3,100/3],5:[100,50,50,50,50],6:[100,50,50,100/3,100/3,100/3],7:[100,100/3,100/3,100/3,100/3,100/3,100/3],8:[50,50,50,50,50,50,50,50],9:[50,50,50,50,50,50,100/3,100/3,100/3],10:[50,50,50,50,100/3,100/3,100/3,100/3,100/3,100/3]}[e][t]},e.getImageHeight=function(e,t){return{0:[100],1:[50],2:[50],3:[50],4:[100/3],5:[100/3],6:[100/3],7:[25],8:[25],9:[25],10:[25]}[e]},e.changeFocusImage=function(t,a){var s=e.state.focusImage,r=e.props.images.length;t.nativeEvent.wheelDelta<0?s>=r-1?s=0:s+=1:s<=0?s=r-1:s-=1,e.setState({focusImage:s})},e}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{className:Me.a.ImagesWrapper,children:[this.props.images.map((function(t,a){if(a<=10)return Object(s.jsx)("div",{style:{width:e.getImageWidth(e.props.images.length,a)+"%",height:e.getImageHeight(e.props.images.length,a)+"%"},children:Object(s.jsx)("img",{src:t,className:Me.a.Image,onClick:function(){e.setState({focusImage:a})}})},a)})),this.state.focusImage>-1&&Object(s.jsxs)(n.a.Fragment,{children:[Object(s.jsx)("img",{className:Me.a.FocusImage,src:this.props.images[this.state.focusImage],onClick:function(){e.setState({focusImage:-1})},onWheel:this.changeFocusImage}),Object(s.jsx)(ae,{close:function(){e.setState({focusImage:-1})}})]})]})}}]),a}(n.a.Component),Ne=function(e,t){var a,s;return(null===(a=e[t])||void 0===a||null===(s=a.public)||void 0===s?void 0:s.name)?e[t].public.name:t.substr(0,10)},Se=a(35),De=a.n(Se);var we=function(e){e.author;var t={text:e.message.text,images:e.message.images};e.message.isForward&&(t={text:e.message.body.text,images:e.message.body.images});var a=[De.a.Message];return e.author&&a.push(De.a.MessageAuthor),!e.images||e.replyMessage||e.isForward||a.push(De.a.MessageWithImages),Object(s.jsx)("div",{className:De.a.MessageWrapper,onMouseDown:e.toggleSelectMessageHandler,onMouseUp:e.toggleSelectMessageHandler,onDoubleClick:e.onDoubleClick,children:Object(s.jsxs)("div",{className:a.join(" "),children:[e.message.isForward&&Object(s.jsxs)("div",{className:De.a.ForwardMessage,children:["\u041f\u0435\u0440\u0435\u0441\u043b\u0430\u043d\u043e \u043e\u0442 ",Ne(e.users,e.message.body.user)]}),!e.author&&!e.message.isForward&&Object(s.jsx)("div",{className:De.a.AuthorName,children:Ne(e.users,e.message.user)}),e.replyMessage&&Object(s.jsxs)("div",{className:De.a.Reply,children:[Object(s.jsx)("div",{className:De.a.ReplyUser,children:Ne(e.users,e.replyMessage.user)}),Object(s.jsx)(J,{message:e.replyMessage})]}),t.images&&Object(s.jsx)(ye,{images:t.images}),t.text&&Object(s.jsx)("p",{className:De.a.MessageText,children:t.text}),e.select&&Object(s.jsx)("div",{className:De.a.Select}),Object(s.jsx)("div",{className:De.a.Date,children:q(e.message.date)})]})})},Ae=a(74),Te=a.n(Ae),ke=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this,t=this.props.chats;return Object(s.jsx)(ie,{close:this.props.close,show:!0,children:Object(s.jsx)("div",{className:Te.a.wrapper,children:Object.keys(t).map((function(a){var r=t[a];return Object(s.jsxs)("div",{className:Te.a.chat,onClick:function(){e.props.startForward(a)},children:[Object(s.jsx)("div",{className:Te.a.imageWrapper}),Object(s.jsx)("h2",{className:Te.a.name,children:r.name})]},a)}))})})}}]),a}(r.Component),Re=Object(p.b)((function(e){return{chats:e.chats.chats}}))(ke),Ue=a(45),Ee=a.n(Ue),Le=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={images:[]},e.selectFiles=function(t){console.log(typeof t.target.files),Array.from(t.target.files).forEach((function(t,a){console.log(t);var s=new FileReader;s.onloadend=function(t){e.setState((function(e){return{images:[].concat(Object(Oe.a)(e.images),[t.target.result])}}))},s.readAsDataURL(t)}))},e.inputTextRef=n.a.createRef(),e.inputFileRef=n.a.createRef(),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.initImage?this.setState((function(t){return{images:[].concat(Object(Oe.a)(t.images),[e.props.initImage])}})):this.inputFileRef.current.click(),console.log("imageInputModal",this.props.initImage)}},{key:"render",value:function(){var e=this;return Object(s.jsx)(ie,{close:this.props.close,show:this.props.show,children:Object(s.jsxs)("div",{className:Ee.a.Component,children:[this.state.images.length>0?Object(s.jsx)("div",{className:Ee.a.Images,children:Object(s.jsx)(ye,{images:this.state.images})}):Object(s.jsx)("div",{className:Ee.a.TitleNoImages,children:"\u041d\u0435\u0442 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0439, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u0445"}),Object(s.jsxs)("div",{className:Ee.a.ControlButtons,children:[Object(s.jsx)("input",{className:Ee.a.InputText,type:"text",ref:this.inputTextRef,placeholder:"\u041f\u043e\u0434\u043f\u0438\u0441\u044c"}),Object(s.jsxs)("div",{className:Ee.a.InputWrapper,children:[Object(s.jsx)("input",{multiple:!0,id:"inputFile",type:"file",onChange:this.selectFiles,style:{display:"none"}}),Object(s.jsx)("label",{className:Ee.a.Button,ref:this.inputFileRef,htmlFor:"inputFile",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b"})]}),Object(s.jsx)("button",{className:Ee.a.Button,onClick:function(){e.props.send(!1,e.inputTextRef.current.value,e.state.images),e.props.close()},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})})}}]),a}(r.Component),We=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){return Object(s.jsxs)(ie,{show:!0,close:this.props.close,children:[Object(s.jsx)("div",{onClick:this.props.chatExit,children:"\u0412\u044b\u0439\u0442\u0438 \u0441 \u0447\u0430\u0442\u0430"}),this.props.isAdmin&&Object(s.jsx)("div",{onClick:this.props.deleteChat,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0447\u0430\u0442"})]})}}]),a}(r.Component),Be=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={selectMessages:[],canDeleteMessages:!1,forwardMessages:null,showImageModal:!1,imageModalInitImage:null,replyMessage:null},e.sendMessage=function(t,a,s){t?e.props.sendMessage(e.props.match.params.id,e.inputRef.current.value,[],e.state.replyMessage):e.props.sendMessage(e.props.match.params.id,a,s,e.state.replyMessage),e.inputRef.current.value=""},e.getMessageFromChatEntry=function(t){var a=e.props.chats[e.props.match.params.id];return a.messages[t]?e.props.messages[a.messages[t].message]:null},e.deleteMessages=function(){e.props.chats[e.props.match.params.id];e.state.selectMessages.map((function(t){e.state.canDeleteMessages&&e.props.deleteMessage(e.props.match.params.id,t)})),e.setState({selectMessages:[]})},e.SelectConfig={},e.toggleSelectMessageHandler=function(t,a){"mousedown"==a.type&&(e.SelectConfig[t]=Date.now(),-1!=e.state.selectMessages.indexOf(t)&&e.toggleSelectMessage(t)),"mouseup"==a.type&&(Date.now()-e.SelectConfig[t])/1e3>.2&&(e.toggleSelectMessage(t),e.SelectConfig[t]=0)},e.toggleSelectMessage=function(t){var a=Object(Oe.a)(e.state.selectMessages);-1==e.state.selectMessages.indexOf(t)?a.push(t):a.splice(a.indexOf(t),1);var s=e.canDeleteMessages(a);e.setState({selectMessages:a,canDeleteMessages:s})},e.canDeleteMessages=function(t){var a=e.props.UID,s=e.props.chats[e.props.match.params.id].creator,r=!0;return t.length<1?r=!1:t.forEach((function(t){var n;r*=(a==s||a==(null===(n=e.getMessageFromChatEntry(t))||void 0===n?void 0:n.user))&&!!e.props.chats[e.props.match.params.id].messages[t]})),!!r},e.showImageModal=function(){e.setState({showImageModal:!0})},e.hideImageModal=function(){e.setState({showImageModal:!1,imageModalInitImage:null})},e.chekClipboard=function(t){if(t.clipboardData.files.length>0){var a=t.clipboardData.files[0],s=new FileReader;s.onloadend=function(t){t.target.result.match(t)&&e.setState({showImageModal:!0,imageModalInitImage:t.target.result})},s.readAsDataURL(a)}},e.forwardMessages=function(t){e.setState({forwardMessages:!0}),e.state.selectMessages.forEach((function(a){e.props.forwardMessage(t,e.getMessageFromChatEntry(a))})),e.setState({forwardMessages:!1,selectMessages:[]}),e.props.history.push("/chats/"+t)},e.inputRef=n.a.createRef(),e}return Object(h.a)(a,[{key:"componentDidUpdate",value:function(e,t){var a,s;if(this.props.match.params.id!=e.match.params.id)return this.setState({selectMessages:[],canDeleteMessages:!1,forwardMessages:!1,replyMessage:!1}),void(this.props.chats[this.props.match.params.id]||this.props.getChat(this.props.match.params.id));if((null===(a=this.props.chats[this.props.match.params.id])||void 0===a?void 0:a.messages)!=(null===(s=e.chats[this.props.match.params.id])||void 0===s?void 0:s.messages)){var r=Object(Oe.a)(t.selectMessages),n=this.props.chats[this.props.match.params.id].messages,c=this.state.replyMessage;n?(r=r.filter((function(e){return n[e]})),c&&!n[c.chatMessageId]&&(c=!1)):(r=[],c=!1),this.setState({selectMessages:r,canDeleteMessages:this.canDeleteMessages(r),replyMessage:c})}}},{key:"render",value:function(){var e=this,t=this.props.chats[this.props.match.params.id],a=[];if(t&&t.messages&&Object.keys(t.messages).map((function(s,r){if(e.props.messages[t.messages[s].message]){var n=Object(m.a)(Object(m.a)({},e.getMessageFromChatEntry(s)),{},{chatMessageId:s});a.push(n)}})),a.sort((function(e,t){return e.date-t.date})),!t||"LOADING"==t)return Object(s.jsx)("div",{className:Ce.a.Chat,children:Object(s.jsx)("div",{className:Ce.a.Status,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})});if("NOT_EXIST"==t){var r=null;return window.innerWidth<=650&&(r=Object(s.jsx)("br",{})),Object(s.jsx)("div",{className:Ce.a.Chat,onClick:function(){e.props.history.push("/chats")},children:Object(s.jsxs)("div",{className:Ce.a.Status,children:["\u0427\u0430\u0442\u0430 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 ",r," \u0438\u043b\u0438 ",r," \u043e\u043d \u0431\u044b \u0443\u0434\u0430\u043b\u0435\u043d"]})})}var n=null;n=this.state.selectMessages.length<1?Object(s.jsxs)("div",{className:Ce.a.HeaderInfo,children:[Object(s.jsx)("img",{className:Ce.a.HeaderBackArrow,onClick:function(){e.props.history.push("/chats")},src:"/Images/backArrow.svg"}),Object(s.jsx)("div",{className:Ce.a.HeaderName,children:t.name}),Object(s.jsx)("img",{className:Ce.a.HeaderThreeDots,onClick:function(){e.setState({showChatMenu:!0})},src:"/Images/threeDots.svg"})]}):Object(s.jsxs)("div",{className:Ce.a.HeaderSelect,children:[Object(s.jsxs)("div",{className:Ce.a.HeaderButtonsWrapper,children:[this.state.canDeleteMessages&&Object(s.jsx)("button",{className:Ce.a.HeaderButton,onClick:this.deleteMessages,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),Object(s.jsx)("button",{className:Ce.a.HeaderButton,onClick:function(){e.setState({forwardMessages:!0})},children:"\u041f\u0435\u0440\u0435\u0441\u043b\u0430\u0442\u044c"})]}),Object(s.jsx)("button",{className:Ce.a.HeaderButtonCancel,onClick:function(){e.setState({selectMessages:[]})},children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]});var c=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return Object(s.jsxs)("div",{className:Ce.a.Chat,children:[n,Object(s.jsx)("div",{className:Ce.a.ChatWindow,style:{height:c-120-(this.state.replyMessage?50:0)},children:a.map((function(t){return Object(s.jsx)(we,{toggleSelectMessageHandler:function(a){e.toggleSelectMessageHandler(t.chatMessageId,a)},select:-1!=e.state.selectMessages.indexOf(t.chatMessageId),author:t.user==e.props.UID,message:t,onDoubleClick:function(){e.setState({replyMessage:t})},users:e.props.users,replyMessage:e.getMessageFromChatEntry(t.replyChatMessageId)},t.id)}))}),this.state.replyMessage&&Object(s.jsxs)("div",{className:Ce.a.ReplyWrapper,children:[Object(s.jsx)("div",{className:Ce.a.ReplyUser,children:this.state.replyMessage.user}),Object(s.jsx)("div",{className:Ce.a.ReplyMessage,children:Object(s.jsx)(J,{message:this.state.replyMessage})}),Object(s.jsx)("span",{className:Ce.a.ReplyCancel,onClick:function(){e.setState({replyMessage:null})},children:"\u2716"})]}),Object.values(t.members).indexOf(this.props.UID)>-1?Object(s.jsxs)("div",{className:Ce.a.InputWrapper,children:[Object(s.jsx)("textarea",{ref:this.inputRef,className:Ce.a.Input,onPaste:this.chekClipboard}),Object(s.jsx)("div",{className:Ce.a.SendIconWrapper,onClick:this.showImageModal,children:Object(s.jsx)("img",{className:Ce.a.SendIcon,src:"/Images/camera.svg"})}),Object(s.jsx)("div",{className:Ce.a.SendIconWrapper,onClick:this.sendMessage,children:Object(s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-send "+Ce.a.sendIcon,viewBox:"0 0 24 24",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[Object(s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),Object(s.jsx)("line",{x1:"10",y1:"14",x2:"21",y2:"3"}),Object(s.jsx)("path",{d:"M21 3l-6.5 18a0.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a0.55 .55 0 0 1 0 -1l18 -6.5"})]})})]}):Object(s.jsx)("div",{className:Ce.a.EnterToChat,onClick:function(){e.props.enterToChat(e.props.match.params.id)},children:"\u0412\u0441\u0442\u0443\u043f\u0438\u0442\u044c \u0432 \u0447\u0430\u0442"}),this.state.showChatMenu&&Object(s.jsx)(We,{close:function(){e.setState({showChatMenu:!1})},chatExit:function(){e.props.chatExit(e.props.match.params.id),e.props.history.push("/chats")},isAdmin:this.props.UID==t.creator,deleteChat:function(){e.props.deleteChat(e.props.match.params.id)}}),this.state.forwardMessages&&Object(s.jsx)(Re,{startForward:this.forwardMessages,close:function(){e.setState({forwardMessages:!1})}}),this.state.showImageModal&&Object(s.jsx)(Le,{close:this.hideImageModal,show:this.state.showImageModal,text:this.inputRef.current.value,initImage:this.state.imageModalInitImage,send:this.sendMessage})]})}}]),a}(r.Component),He=Object(p.b)((function(e){return{chats:e.chats.chats,messages:e.chats.messages,UID:e.auth.UID,users:e.chats.users}}),(function(e){return{sendMessage:function(t,a,s,r){return e(function(e,t,a,s){return function(r,n){var c=n().auth.UID,i=j.a.database.ServerValue.TIMESTAMP,o=t.trim();o.length<1&&a.length<1||j.a.database().ref("messages/").push({user:c,text:o,images:a,date:i}).then((function(t){var a=null;s&&(a=s.chatMessageId),j.a.database().ref("chats/"+e+"/messagesData/messages").push({message:t.path.pieces_[1],replyChatMessageId:a}).then((function(){j.a.database().ref("chats/"+e+"/messagesData/lastChangeDate").set(i)}))}))}}(t,a,s,r))},deleteMessage:function(t,a){return e(function(e,t){return function(a,s){j.a.database().ref("/chats/"+e+"/messagesData/messages/"+t).remove()}}(t,a))},forwardMessage:function(t,a){return e(function(e,t){return function(a,s){var r=s().auth.UID,n=j.a.database.ServerValue.TIMESTAMP,c=null;c=t.isForward?Object(m.a)({},t.body):Object(m.a)({},t),j.a.database().ref("messages/").push({user:r,body:c,isForward:!0,date:n}).then((function(t){j.a.database().ref("chats/"+e+"/messagesData/messages/").push({message:t.path.pieces_[1]}).then((function(){j.a.database().ref("chats/"+e+"/messagesData/lastChangeDate").set(n)}))}))}}(t,a))},getChat:function(t){return e(R(t))},enterToChat:function(t){return e(T(t))},chatExit:function(t){return e(function(e){return function(t,a){var s=a().auth.UID;j.a.database().ref("users/"+s+"/private/chats").orderByChild("chat").startAt(e).endAt(e+"\uf8ff").once("value",(function(t){var a=Object.keys(t.val())[0];j.a.database().ref("users/"+s+"/private/chats/"+a).remove(),j.a.database().ref("chats/"+e+"/chatData/members/").orderByValue().startAt(s).endAt(s+"\uf8ff").once("value",(function(t){var a=Object.keys(t.val())[0];j.a.database().ref("chats/"+e+"/chatData/members/").remove(a)}))}))}}(t))},deleteChat:function(t){return e(E(t))}}}))(Object(L.g)(Be)),Fe=a(114),Pe=a.n(Fe),ze=function(e){return Object(s.jsx)("div",{className:Pe.a.NoSelectChat,children:Object(s.jsx)("h1",{className:Pe.a.Title,children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0447\u0430\u0442..."})})},Ve=[{path:"/auth-email",Component:B}],Ge=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=window.innerWidth<651;return Object(s.jsxs)(n.a.Fragment,{children:[Object(s.jsxs)(L.d,{children:[e&&Object(s.jsx)(L.b,{path:P}),Object(s.jsx)(L.b,{path:"/chats",component:_e})]}),!e&&Object(s.jsx)(L.b,{exact:!0,path:"/chats",component:ze}),Object(s.jsx)(L.b,{exact:!0,path:P,render:function(){return Object(s.jsx)(He,{})}})]})}}]),a}(r.Component),Je=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).pushInfo=function(){e.props.database.ref("/test").push({date:Date.now()}).then((function(e){}))},e.getInfo=function(){e.props.database.ref("/test").on("value",(function(e){}))},e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",(function(){e.forceUpdate()}))}},{key:"render",value:function(){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return this.props.UID?Object(s.jsxs)("div",{className:F.a.MainWindow,style:{height:e},children:[Object(s.jsx)(Ge,{}),Object(s.jsx)(L.a,{from:"/",to:"/chats"})]}):Object(s.jsx)(n.a.Fragment,{children:Object(s.jsxs)(L.d,{children:[Ve.map((function(e){var t=e.path,a=e.Component;return Object(s.jsx)(L.b,{path:t,component:a},t)})),Object(s.jsx)(L.a,{exact:!0,to:"/auth-email"})]})})}}]),a}(r.Component),Ze=Object(p.b)((function(e){return{UID:e.auth.UID}}),(function(e){return{subscribeInit:function(){return e(k())}}}))(Je),Ke=a(75),Xe=a(167),qe={UID:"isnP8gd3YmM0eQiRM0hIHr2hBhy1",isAuth:!0,loading:!1,error:null,userListeners:[]},Ye=a(50),Qe={chats:{},messages:{},userChatsList:[],searchChatsList:[],users:{}};j.a.initializeApp({apiKey:"AIzaSyC2Gf1VqDDnCCth5xGCVbLL6coHBWJoq6Y",authDomain:"chat-cc558.firebaseapp.com",projectId:"chat-cc558",storageBucket:"chat-cc558.appspot.com",messagingSenderId:"802123311223",appId:"1:802123311223:web:13cd6546011edba6f9fe72"}),j.a.auth().setPersistence(j.a.auth.Auth.Persistence.NONE);var $e=Object(Ke.b)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(m.a)(Object(m.a)({},e),{},{loading:!0,UID:null,error:null});case b:return Object(m.a)(Object(m.a)({},e),{},{loading:!1,UID:t.UID});case v:return Object(m.a)(Object(m.a)({},e),{},{loading:!1,error:t.error});case O:return Object(m.a)(Object(m.a)({},e),{},{loading:!1,UID:null,error:null});case A:return Object(m.a)(Object(m.a)({},e),{},{userListeners:[].concat(Object(Oe.a)(e.userListeners),[t.ref])});default:return e}},chats:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(m.a)(Object(m.a)({},e),{},{userChatsList:t.chatsList});case N:return Object(m.a)(Object(m.a)({},e),{},{searchChatsList:t.chatsList});case I:return Object(m.a)(Object(m.a)({},e),{},{chats:Object(m.a)(Object(m.a)({},e.chats),{},Object(Ye.a)({},t.chatId,"LOADING"))});case C:var a=Object(m.a)({},e.chats),s={};return a[t.chatId].messages&&(s=Object(m.a)({},a[t.chatId].messages)),a[t.chatId]=Object(m.a)(Object(m.a)({},t.chatData),{},{messages:s}),Object(m.a)(Object(m.a)({},e),{},{chats:a});case x:var r=Object(m.a)({},e.chats);return r[t.chatId]="NOT_EXIST",Object(m.a)(Object(m.a)({},e),{},{chats:r});case S:var n={};e.chats[t.chatId].messages&&(n=Object(m.a)(Object(m.a)({},e.chats[t.chatId].messages),{},Object(Ye.a)({},t.chatMessageId,t.chatMessage)));var c=t.lastChangeMessagesDate;return e.chats[t.chatId]&&e.chats[t.chatId].lastChangeMessagesDate>c&&(c=e.chats[t.chatId].lastChangeMessagesDate),Object(m.a)(Object(m.a)({},e),{},{chats:Object(m.a)(Object(m.a)({},e.chats),{},Object(Ye.a)({},t.chatId,Object(m.a)(Object(m.a)({},e.chats[t.chatId]),{},{messages:n,lastChangeMessagesDate:c})))});case D:if("NOT_EXIST"==e.chats[t.chatId])return e;var i={};return e.chats[t.chatId].messages&&(i=Object(m.a)({},e.chats[t.chatId].messages)),delete i[t.chatMessageId],Object(m.a)(Object(m.a)({},e),{},{chats:Object(m.a)(Object(m.a)({},e.chats),{},Object(Ye.a)({},t.chatId,Object(m.a)(Object(m.a)({},e.chats[t.chatId]),{},{messages:i})))});case w:var o=Object(m.a)({},e.messages);return o[t.messageId]=Object(m.a)({},t.messageData),Object(m.a)(Object(m.a)({},e),{},{messages:o});case _:var h={};return t.isMainUser?h.public=t.userData:h=Object(m.a)({},t.userData),Object(m.a)(Object(m.a)({},e),{},{users:Object(m.a)(Object(m.a)({},e.users),{},Object(Ye.a)({},t.user,h))});case M:return Qe;default:return e}}}),et=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ke.c,tt=Object(Ke.d)($e,et(Object(Ke.a)(Xe.a)));i.a.render(Object(s.jsx)(p.a,{store:tt,children:Object(s.jsx)(G.a,{children:Object(s.jsx)(Ze,{})})}),document.getElementById("root"))},52:function(e,t,a){e.exports={Auth:"Auth_Auth__3l2yv",Title:"Auth_Title__1FXhr",Input:"Auth_Input__3bvVA",Button:"Auth_Button__23EKZ",IsLogin:"Auth_IsLogin__3FivA",Error:"Auth_Error__2a8uR"}},58:function(e,t,a){e.exports={ChatsList:"ChatsList_ChatsList__1wB8U",Navigation:"ChatsList_Navigation__3Mlxq",Input:"ChatsList_Input__1MLpz",Burger:"ChatsList_Burger__DT2vX",ChatsItems:"ChatsList_ChatsItems__1kswi",AddWrapper:"ChatsList_AddWrapper__2MY7l",Add:"ChatsList_Add__3_Fwy",NoSearchChat:"ChatsList_NoSearchChat__2pHWo"}},73:function(e,t,a){e.exports={Navigation:"Navigation_Navigation__8G14j",ListItem:"Navigation_ListItem__JckRG"}},74:function(e,t,a){e.exports={wrapper:"ListModal_wrapper__oDhzB",chat:"ListModal_chat__BiTiE",name:"ListModal_name__2CzIo",imageWrapper:"ListModal_imageWrapper__10K_E"}},86:function(e,t,a){e.exports={ImagesWrapper:"ImagesBlock_ImagesWrapper__1Mp6x",Image:"ImagesBlock_Image__3mjq6",FocusImageWrapper:"ImagesBlock_FocusImageWrapper__1_OI3",FocusImage:"ImagesBlock_FocusImage__BYiB1"}}},[[473,1,2]]]);
//# sourceMappingURL=main.77b42bdb.chunk.js.map